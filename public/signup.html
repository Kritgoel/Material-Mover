<!doctype html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <title>Sign Up - Material Mover</title>
    <link rel="stylesheet" href="/css/style.css">
  </head>
  <body>
    <main class="container auth">
      <h2>Sign Up</h2>
      <form id="signupForm">
        <label>Email<input type="email" id="email" required placeholder="Enter your email"></label>
        <label>Password<input type="password" id="password" required placeholder="Enter your password"></label>
        <label>I want to:
          <select id="role" required>
            <option value="">Select your role</option>
            <option value="buyer">Buy Materials</option>
            <option value="seller">Sell Materials</option>
          </select>
        </label>
        <button type="submit">Sign Up</button>
      </form>
      <div class="auth-help">
        <p><strong>Choose your role:</strong></p>
        <ul>
          <li><strong>Buyer:</strong> Search and view available materials</li>
          <li><strong>Seller:</strong> List and manage your materials</li>
        </ul>
        <p class="auth-note">Note: Admin access is granted by existing administrators only.</p>
        <p>Have an account? <a href="/login.html">Login</a></p>
      </div>
    </main>
    <script>
      document.getElementById('signupForm').addEventListener('submit', async (e) => {
        e.preventDefault();
        const email = document.getElementById('email').value;
        const password = document.getElementById('password').value;
        const role = document.getElementById('role').value;
        
        if (!role) {
          alert('Please select your role (Buyer or Seller)');
          return;
        }

        const resp = await fetch('/api/auth/signup', { 
          method: 'POST', 
          headers: { 'Content-Type': 'application/json' }, 
          body: JSON.stringify({ email, password, role }) 
        });
        const j = await resp.json();
        if (resp.ok) {
          alert(`Account created as ${j.role}, please login`);
          location.href = '/login.html';
        } else alert(j.message || JSON.stringify(j));
      });
    </script>
  </body>
</html>
